<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BridgeTemplate Architecture Explorer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1a1a1a;
            color: white;
            overflow: hidden;
        }
        
        /* Navigation */
        .nav-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            padding: 0 20px;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-title {
            font-size: 20px;
            font-weight: 600;
            margin-right: 30px;
        }
        
        .nav-breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #aaa;
        }
        
        .nav-breadcrumb a {
            color: #5ac8fa;
            text-decoration: none;
            cursor: pointer;
        }
        
        .nav-breadcrumb a:hover {
            text-decoration: underline;
        }
        
        /* Page Container */
        .page-container {
            position: absolute;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: auto;
            padding: 20px;
        }
        
        /* Page Styles */
        .page {
            display: none;
            min-height: 100%;
        }
        
        .page.active {
            display: block;
        }
        
        /* Main Architecture View */
        .architecture {
            position: relative;
            width: 100%;
            min-width: 1400px;
            min-height: 900px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 20px;
            padding: 40px;
        }
        
        /* Components */
        .component {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .component:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }
        
        .component h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }
        
        .component p {
            font-size: 14px;
            opacity: 0.8;
        }
        
        /* Component Types */
        .app-component {
            border-color: #007aff;
            background: rgba(0, 122, 255, 0.1);
        }
        
        .core-component {
            border-color: #34c759;
            background: rgba(52, 199, 89, 0.1);
        }
        
        .module-component {
            border-color: #ff9500;
            background: rgba(255, 149, 0, 0.1);
        }
        
        .broken-component {
            border-color: #ff3b30;
            background: rgba(255, 59, 48, 0.1);
        }
        
        .protocol-component {
            border-color: #af52de;
            background: rgba(175, 82, 222, 0.1);
        }
        
        /* Connections */
        svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .connection {
            fill: none;
            stroke-width: 3;
            opacity: 0.7;
        }
        
        .connection-working {
            stroke: #34c759;
        }
        
        .connection-broken {
            stroke: #ff3b30;
            stroke-dasharray: 5, 5;
        }
        
        .connection-conflict {
            stroke: #ff9500;
            stroke-dasharray: 10, 5;
        }
        
        /* Detail Pages */
        .detail-header {
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }
        
        .detail-header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }
        
        .detail-header .subtitle {
            font-size: 18px;
            color: #aaa;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .detail-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
        }
        
        .detail-section h2 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #5ac8fa;
        }
        
        .detail-section ul {
            list-style: none;
            padding: 0;
        }
        
        .detail-section li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .detail-section li:last-child {
            border-bottom: none;
        }
        
        /* Status badges */
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 5px;
        }
        
        .status-working {
            background: #34c759;
            color: white;
        }
        
        .status-broken {
            background: #ff3b30;
            color: white;
        }
        
        .status-incompatible {
            background: #ff9500;
            color: white;
        }
        
        /* Code blocks */
        .code-block {
            background: #000;
            border-radius: 8px;
            padding: 15px;
            font-family: 'SF Mono', Consolas, monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 10px 0;
        }
        
        /* Issue cards */
        .issue-card {
            background: rgba(255, 59, 48, 0.1);
            border-left: 3px solid #ff3b30;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .success-card {
            background: rgba(52, 199, 89, 0.1);
            border-left: 3px solid #34c759;
        }
        
        /* Info boxes */
        .info-box {
            position: absolute;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            font-size: 14px;
            max-width: 300px;
            backdrop-filter: blur(10px);
        }
        
        .info-box h4 {
            margin-bottom: 8px;
            color: #5ac8fa;
        }
        
        /* Legend */
        .legend {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(20px);
            padding: 20px;
            border-radius: 15px;
            z-index: 100;
            max-width: 250px;
        }
        
        .legend h3 {
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .legend-color {
            width: 30px;
            height: 3px;
            margin-right: 10px;
        }
        
        .legend-box {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            border-radius: 4px;
            border: 2px solid;
        }
        
        /* Module diagram */
        .module-diagram {
            position: relative;
            min-height: 600px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 15px;
            padding: 40px;
            margin: 20px 0;
        }
        
        /* Clickable hint */
        .click-hint {
            position: absolute;
            background: rgba(0, 122, 255, 0.2);
            border: 2px solid #007aff;
            border-radius: 8px;
            padding: 8px 12px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .component:hover .click-hint {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="nav-bar">
        <div class="nav-title">BridgeTemplate Explorer</div>
        <div class="nav-breadcrumb" id="breadcrumb">
            <a onclick="showPage('main')">Main Architecture</a>
        </div>
    </div>
    
    <!-- Page Container -->
    <div class="page-container">
        
        <!-- Main Architecture Page -->
        <div class="page active" id="page-main">
            <div class="architecture">
                <svg id="main-connections"></svg>
                
                <!-- User Interface Layer -->
                <div class="component app-component" style="left: 600px; top: 20px; width: 250px;" onclick="showPage('app')">
                    <h3>NewBridgeMac App</h3>
                    <p>The main application interface</p>
                    <span class="status-badge status-working">Running</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <!-- Core Systems -->
                <div class="component core-component" style="left: 550px; top: 140px; width: 350px;" onclick="showPage('module-manager')">
                    <h3>Module Manager</h3>
                    <p>Loads and manages all modules</p>
                    <span class="status-badge status-working">Working</span>
                    <span class="status-badge status-broken">Can't load real modules</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component core-component" style="left: 300px; top: 280px; width: 250px;" onclick="showPage('module-discovery')">
                    <h3>ModuleDiscovery</h3>
                    <p>Finds modules (but returns mocks)</p>
                    <span class="status-badge status-broken">Hardcoded</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component core-component" style="left: 650px; top: 280px; width: 250px;" onclick="showPage('version-manager')">
                    <h3>Version Manager</h3>
                    <p>Handles module versioning</p>
                    <span class="status-badge status-working">Working</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <!-- Protocols -->
                <div class="component protocol-component" style="left: 1000px; top: 150px; width: 200px;" onclick="showPage('bridge-protocol')">
                    <h3>BridgeModule Protocol</h3>
                    <p>Original module interface</p>
                    <span class="status-badge status-working">Expected</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component protocol-component" style="left: 1000px; top: 450px; width: 200px;" onclick="showPage('universal-protocol')">
                    <h3>UniversalComponent</h3>
                    <p>Competing module interface</p>
                    <span class="status-badge status-incompatible">Incompatible</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <!-- Real Modules -->
                <div class="component broken-component" style="left: 50px; top: 450px; width: 180px;" onclick="showPage('terminal')">
                    <h3>Terminal (Real)</h3>
                    <p>31KB full terminal</p>
                    <span class="status-badge status-broken">Not Loaded</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component broken-component" style="left: 250px; top: 450px; width: 180px;" onclick="showPage('personal-assistant')">
                    <h3>PersonalAssistant</h3>
                    <p>AI, Tasks, Calendar</p>
                    <span class="status-badge status-incompatible">Wrong Protocol</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component broken-component" style="left: 450px; top: 450px; width: 180px;" onclick="showPage('projects')">
                    <h3>Projects</h3>
                    <p>Project management</p>
                    <span class="status-badge status-incompatible">Wrong Protocol</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component broken-component" style="left: 650px; top: 450px; width: 180px;" onclick="showPage('documents')">
                    <h3>Documents</h3>
                    <p>Document editor</p>
                    <span class="status-badge status-incompatible">Wrong Protocol</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <div class="component broken-component" style="left: 850px; top: 450px; width: 180px;" onclick="showPage('settings')">
                    <h3>Settings</h3>
                    <p>App configuration</p>
                    <span class="status-badge status-incompatible">Wrong Protocol</span>
                    <div class="click-hint">Click to explore ‚Üí</div>
                </div>
                
                <!-- Info Boxes -->
                <div class="info-box" style="left: 20px; top: 20px;">
                    <h4>üî¥ Current State</h4>
                    <p>We removed SimplifiedModuleDiscovery, MockModules, and UniversalModuleAdapter. Now we have a cleaner view of the core conflict.</p>
                </div>
                
                <div class="info-box" style="left: 300px; top: 600px;">
                    <h4>‚ö° The Voltage Problem</h4>
                    <p>All modules speak UniversalComponent (220V) but the app only understands BridgeModule (110V). We need to convert one to match the other!</p>
                </div>
            </div>
        </div>
        
        <!-- Module Manager Detail Page -->
        <div class="page" id="page-module-manager">
            <div class="detail-header">
                <h1>Module Manager</h1>
                <p class="subtitle">The central hub that manages all modules in the system</p>
            </div>
            
            <div class="module-diagram">
                <svg id="mm-connections"></svg>
                
                <div class="component core-component" style="left: 400px; top: 50px; width: 300px;">
                    <h3>ModuleManager Class</h3>
                    <p>@MainActor, ObservableObject</p>
                    <span class="status-badge status-working">Core System</span>
                </div>
                
                <div class="component broken-component" style="left: 100px; top: 200px; width: 200px;">
                    <h3>loadedModules</h3>
                    <p>[String: BridgeModule]</p>
                    <span class="status-badge status-broken">Empty - no real modules</span>
                </div>
                
                <div class="component core-component" style="left: 350px; top: 200px; width: 200px;">
                    <h3>ModuleDiscovery</h3>
                    <p>Finds modules to load</p>
                    <span class="status-badge status-broken">Returns mocks only</span>
                </div>
                
                <div class="component core-component" style="left: 600px; top: 200px; width: 200px;">
                    <h3>Message Queue</h3>
                    <p>Cross-module communication</p>
                    <span class="status-badge status-working">Ready but unused</span>
                </div>
                
                <div class="info-box" style="left: 50px; top: 350px;">
                    <h4>Key Methods</h4>
                    <p>‚Ä¢ loadModule(identifier:version:)<br>
                    ‚Ä¢ unloadModule(identifier:)<br>
                    ‚Ä¢ hotSwap(from:to:)<br>
                    ‚Ä¢ sendMessage(_:)</p>
                </div>
            </div>
            
            <div class="detail-grid">
                <div class="detail-section">
                    <h2>What It Does</h2>
                    <ul>
                        <li>‚úÖ Manages module lifecycle (load/unload)</li>
                        <li>‚úÖ Handles hot-swapping (replace modules while running)</li>
                        <li>‚úÖ Routes messages between modules</li>
                        <li>‚úÖ Manages dependencies</li>
                        <li>‚úÖ Version checking and compatibility</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>Current Problems</h2>
                    <div class="issue-card">
                        <strong>Can't Load Real Modules</strong>
                        <p>ModuleDiscovery returns mocks instead of real modules, so loadedModules is always empty of real functionality.</p>
                    </div>
                    <div class="issue-card">
                        <strong>Protocol Mismatch</strong>
                        <p>Expects BridgeModule but real modules use UniversalComponent.</p>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h2>File Information</h2>
                    <ul>
                        <li><strong>Location:</strong> /Core/ModuleManager/ModuleManager.swift</li>
                        <li><strong>Lines:</strong> ~500</li>
                        <li><strong>Dependencies:</strong> SwiftUI, Combine</li>
                        <li><strong>Protocol:</strong> Expects BridgeModule</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>How It Should Work</h2>
                    <ol>
                        <li>App starts and creates ModuleManager</li>
                        <li>Calls ModuleDiscovery to find modules</li>
                        <li>Loads each discovered module</li>
                        <li>Modules appear in sidebar</li>
                        <li>User clicks module ‚Üí shows real functionality</li>
                    </ol>
                </div>
            </div>
        </div>
        
        <!-- BridgeModule Protocol Detail Page -->
        <div class="page" id="page-bridge-protocol">
            <div class="detail-header">
                <h1>BridgeModule Protocol</h1>
                <p class="subtitle">The original module interface - what the app expects all modules to implement</p>
            </div>
            
            <div class="detail-grid">
                <div class="detail-section">
                    <h2>Protocol Requirements</h2>
                    <div class="code-block">
protocol BridgeModule {
    // Identity
    var id: String { get }
    var displayName: String { get }
    var icon: String { get }
    var version: ModuleVersion { get }
    
    // Interface
    var view: AnyView { get }
    var subModules: [String: BridgeModule] { get }
    var dependencies: [String] { get }
    
    // Lifecycle
    func initialize() async throws
    func cleanup() async
    func canUnload() -> Bool
    
    // Communication
    func receiveMessage(_: ModuleMessage) async throws
}</div>
                </div>
                
                <div class="detail-section">
                    <h2>Key Characteristics</h2>
                    <ul>
                        <li>‚úÖ Uses String IDs (e.g., "com.bridge.terminal")</li>
                        <li>‚úÖ Simple, flat structure</li>
                        <li>‚úÖ Designed for hot-swapping</li>
                        <li>‚úÖ SwiftUI view integration</li>
                        <li>‚úÖ Async lifecycle methods</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>Who Uses This</h2>
                    <div class="success-card">
                        <strong>Module Manager</strong> - Expects all modules to conform to this
                    </div>
                    <div class="success-card">
                        <strong>Main App</strong> - UI is built around this protocol
                    </div>
                    <div class="issue-card">
                        <strong>Terminal Module</strong> - Only real module that uses this (but still not loaded)
                    </div>
                </div>
                
                <div class="detail-section">
                    <h2>Version History</h2>
                    <ul>
                        <li><strong>v1.0.0:</strong> Initial protocol definition</li>
                        <li><strong>v2.0.0:</strong> Added hot-swapping support</li>
                        <li><strong>Current:</strong> Still the expected interface</li>
                    </ul>
                </div>
            </div>
            
            <div class="module-diagram">
                <h2 style="margin-bottom: 20px;">Protocol Usage Flow</h2>
                <svg id="bp-connections"></svg>
                
                <div class="component app-component" style="left: 50px; top: 100px; width: 150px;">
                    <h3>App UI</h3>
                    <p>Shows modules</p>
                </div>
                
                <div class="component protocol-component" style="left: 300px; top: 100px; width: 200px;">
                    <h3>BridgeModule</h3>
                    <p>Protocol definition</p>
                </div>
                
                <div class="component core-component" style="left: 600px; top: 100px; width: 180px;">
                    <h3>Module Manager</h3>
                    <p>Manages modules</p>
                </div>
                
                <div class="component broken-component" style="left: 300px; top: 250px; width: 200px;">
                    <h3>Real Modules</h3>
                    <p>Don't implement this!</p>
                    <span class="status-badge status-incompatible">Use UniversalComponent</span>
                </div>
            </div>
        </div>
        
        <!-- UniversalComponent Protocol Detail Page -->
        <div class="page" id="page-universal-protocol">
            <div class="detail-header">
                <h1>UniversalComponent Protocol</h1>
                <p class="subtitle">The competing module interface - what the real modules actually implement</p>
            </div>
            
            <div class="detail-grid">
                <div class="detail-section">
                    <h2>Protocol Requirements</h2>
                    <div class="code-block">
protocol UniversalComponent: AnyObject, ObservableObject {
    // Identity
    var id: UUID { get }
    var name: String { get }
    var hierarchyLevel: HierarchyLevel { get }
    var version: ComponentVersion { get }
    
    // Structure
    var parent: UniversalComponent? { get set }
    var children: [UniversalComponent] { get }
    var dependencies: [UUID] { get }
    
    // Interface
    var view: AnyView { get }
    var icon: String { get }
    
    // Lifecycle & CICD
    func initialize() async throws
    func cleanup() async throws
    func test() async throws
    func build() async throws
    func deploy() async throws
}</div>
                </div>
                
                <div class="detail-section">
                    <h2>Key Differences from BridgeModule</h2>
                    <div class="issue-card">
                        <strong>UUID vs String IDs</strong>
                        <p>Uses UUID() instead of "com.bridge.module" strings</p>
                    </div>
                    <div class="issue-card">
                        <strong>Hierarchy Levels</strong>
                        <p>Has Module ‚Üí Submodule ‚Üí Epic ‚Üí Story ‚Üí Task hierarchy</p>
                    </div>
                    <div class="issue-card">
                        <strong>Different Version Type</strong>
                        <p>ComponentVersion vs ModuleVersion</p>
                    </div>
                    <div class="issue-card">
                        <strong>Built-in CICD</strong>
                        <p>Has test(), build(), deploy() methods</p>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h2>Who Uses This</h2>
                    <ul>
                        <li>‚ùå PersonalAssistant Module</li>
                        <li>‚ùå Projects Module</li>
                        <li>‚ùå Documents Module</li>
                        <li>‚ùå Settings Module</li>
                        <li>‚úÖ All extend BaseComponent which implements this</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>The Problem</h2>
                    <div class="issue-card">
                        <strong>Complete Incompatibility</strong>
                        <p>This protocol is completely different from BridgeModule. It's like trying to plug a USB-C cable into a Lightning port - they're both valid standards but totally incompatible.</p>
                    </div>
                    <div class="info-box" style="position: relative; left: 0; margin-top: 10px;">
                        <h4>Multiple Definitions</h4>
                        <p>Each module has its own copy of UniversalComponent, causing "ambiguous type" errors!</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Terminal Module Detail Page -->
        <div class="page" id="page-terminal">
            <div class="detail-header">
                <h1>Terminal Module</h1>
                <p class="subtitle">The only real module that uses BridgeModule protocol correctly</p>
            </div>
            
            <div class="detail-grid">
                <div class="detail-section">
                    <h2>Module Features</h2>
                    <ul>
                        <li>‚úÖ Full macOS terminal with PTY support</li>
                        <li>‚úÖ Claude Code integration</li>
                        <li>‚úÖ Multi-tab support</li>
                        <li>‚úÖ ANSI color support</li>
                        <li>‚úÖ Auto-permission system</li>
                        <li>‚úÖ 31KB of real functionality</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>Why It's Not Loading</h2>
                    <div class="issue-card">
                        <strong>ModuleDiscovery Returns Mock</strong>
                        <p>Even though Terminal uses the correct protocol, ModuleDiscovery still returns MockTerminalModule instead.</p>
                    </div>
                    <div class="issue-card">
                        <strong>AutoPermissionSystem Concerns</strong>
                        <p>May have caused the screenshot issues that started this investigation.</p>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h2>File Information</h2>
                    <ul>
                        <li><strong>Location:</strong> /Modules/Terminal/Sources/Terminal/</li>
                        <li><strong>Main File:</strong> TerminalModule.swift (31KB)</li>
                        <li><strong>Protocol:</strong> BridgeModule ‚úÖ</li>
                        <li><strong>Version:</strong> 1.3.0</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>Special Note</h2>
                    <div class="success-card">
                        <strong>Could Actually Work!</strong>
                        <p>This module uses the correct BridgeModule protocol. If we fix ModuleDiscovery to actually load it, this one should work!</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- PersonalAssistant Module Detail Page -->
        <div class="page" id="page-personal-assistant">
            <div class="detail-header">
                <h1>PersonalAssistant Module</h1>
                <p class="subtitle">Comprehensive productivity suite with wrong protocol</p>
            </div>
            
            <div class="module-diagram">
                <h2 style="margin-bottom: 20px;">Module Structure</h2>
                <svg id="pa-connections"></svg>
                
                <div class="component broken-component" style="left: 350px; top: 50px; width: 250px;">
                    <h3>PersonalAssistantModule</h3>
                    <p>extends BaseComponent</p>
                    <span class="status-badge status-incompatible">UniversalComponent</span>
                </div>
                
                <div class="component module-component" style="left: 100px; top: 200px; width: 180px;">
                    <h3>Task Management</h3>
                    <p>Todo lists & tracking</p>
                </div>
                
                <div class="component module-component" style="left: 300px; top: 200px; width: 180px;">
                    <h3>Calendar</h3>
                    <p>Event scheduling</p>
                </div>
                
                <div class="component module-component" style="left: 500px; top: 200px; width: 180px;">
                    <h3>AI Chat</h3>
                    <p>Intelligent assistant</p>
                </div>
                
                <div class="component module-component" style="left: 700px; top: 200px; width: 180px;">
                    <h3>Voice Commands</h3>
                    <p>Voice control</p>
                </div>
            </div>
            
            <div class="detail-grid">
                <div class="detail-section">
                    <h2>Module Features</h2>
                    <ul>
                        <li>4 comprehensive submodules</li>
                        <li>Tab-based navigation UI</li>
                        <li>Task creation and tracking</li>
                        <li>Calendar integration</li>
                        <li>AI-powered chat interface</li>
                        <li>Voice command support</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>The Protocol Problem</h2>
                    <div class="issue-card">
                        <strong>Wrong Interface</strong>
                        <p>Built with UniversalComponent/BaseComponent instead of BridgeModule</p>
                    </div>
                    <div class="issue-card">
                        <strong>Can't Be Loaded</strong>
                        <p>Module Manager doesn't understand UniversalComponent protocol</p>
                    </div>
                    <div class="code-block">
// What it has:
class PersonalAssistantModule: BaseComponent

// What it needs:
class PersonalAssistantModule: BridgeModule</div>
                </div>
            </div>
        </div>
        
        <!-- Module Discovery Detail Page -->
        <div class="page" id="page-module-discovery">
            <div class="detail-header">
                <h1>ModuleDiscovery</h1>
                <p class="subtitle">Should find and load real modules dynamically - currently hardcoded to return mocks</p>
            </div>
            
            <div class="detail-grid">
                <div class="detail-section">
                    <h2>What It Should Do</h2>
                    <ul>
                        <li>Scan /Modules directory</li>
                        <li>Find valid Swift packages</li>
                        <li>Extract module metadata</li>
                        <li>Dynamically load module code</li>
                        <li>Return real module instances</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h2>What It Actually Does</h2>
                    <div class="issue-card">
                        <strong>Hardcoded Module List</strong>
                        <p>Returns a fixed list of known modules instead of scanning</p>
                    </div>
                    <div class="issue-card">
                        <strong>Returns Mock Classes</strong>
                        <p>createModuleInstance() returns MockTerminalModule, MockProjectsModule, etc.</p>
                    </div>
                    <div class="code-block">
// Current implementation:
case "com.bridge.terminal":
    return MockTerminalModule()  // üò¢
    
// Should be:
case "com.bridge.terminal":
    return Terminal.TerminalModule()  // üéâ</div>
                </div>
                
                <div class="detail-section">
                    <h2>Why This Happened</h2>
                    <p>The original ModuleDiscovery tried to do real dynamic loading but hit circular dependency issues. This "simplified" version was created as a temporary fix but became permanent.</p>
                </div>
                
                <div class="detail-section">
                    <h2>File Information</h2>
                    <ul>
                        <li><strong>Location:</strong> /Core/ModuleManager/ModuleDiscovery.swift</li>
                        <li><strong>Status:</strong> Simplified/broken version</li>
                        <li><strong>Contains:</strong> Mock module definitions</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Legend (appears on all pages) -->
        <div class="legend">
            <h3>Component Status</h3>
            <div class="legend-item">
                <div class="legend-box app-component"></div>
                <span>Application</span>
            </div>
            <div class="legend-item">
                <div class="legend-box core-component"></div>
                <span>Core System</span>
            </div>
            <div class="legend-item">
                <div class="legend-box module-component"></div>
                <span>Module/Feature</span>
            </div>
            <div class="legend-item">
                <div class="legend-box broken-component"></div>
                <span>Broken/Incompatible</span>
            </div>
            <div class="legend-item">
                <div class="legend-box protocol-component"></div>
                <span>Protocol/Interface</span>
            </div>
            <br>
            <h3>Connection Types</h3>
            <div class="legend-item">
                <div class="legend-color connection-working"></div>
                <span>Working</span>
            </div>
            <div class="legend-item">
                <div class="legend-color connection-broken"></div>
                <span>Broken</span>
            </div>
            <div class="legend-item">
                <div class="legend-color connection-conflict"></div>
                <span>Protocol Conflict</span>
            </div>
        </div>
    </div>
    
    <script>
        // Current page
        let currentPage = 'main';
        
        // Page navigation
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show requested page
            document.getElementById(`page-${pageId}`).classList.add('active');
            
            // Update breadcrumb
            updateBreadcrumb(pageId);
            
            // Draw connections for the page
            setTimeout(() => drawConnections(pageId), 100);
            
            currentPage = pageId;
        }
        
        // Update breadcrumb navigation
        function updateBreadcrumb(pageId) {
            const breadcrumb = document.getElementById('breadcrumb');
            let html = '<a onclick="showPage(\'main\')">Main Architecture</a>';
            
            const pageNames = {
                'module-manager': 'Module Manager',
                'bridge-protocol': 'BridgeModule Protocol',
                'universal-protocol': 'UniversalComponent Protocol',
                'terminal': 'Terminal Module',
                'personal-assistant': 'PersonalAssistant Module',
                'projects': 'Projects Module',
                'documents': 'Documents Module',
                'settings': 'Settings Module',
                'module-discovery': 'ModuleDiscovery',
                'version-manager': 'Version Manager',
                'app': 'NewBridgeMac App'
            };
            
            if (pageId !== 'main' && pageNames[pageId]) {
                html += ` <span>‚Üí</span> <span>${pageNames[pageId]}</span>`;
            }
            
            breadcrumb.innerHTML = html;
        }
        
        // Connection data for different pages
        const connections = {
            main: [
                { from: [600, 95], to: [725, 140], type: 'working' },
                { from: [725, 210], to: [425, 280], type: 'working' },
                { from: [725, 210], to: [775, 280], type: 'working' },
                { from: [900, 170], to: [1100, 170], type: 'working' },
                { from: [425, 330], to: [140, 450], type: 'broken' },
                { from: [425, 330], to: [340, 450], type: 'broken' },
                { from: [425, 330], to: [540, 450], type: 'broken' },
                { from: [425, 330], to: [740, 450], type: 'broken' },
                { from: [425, 330], to: [940, 450], type: 'broken' },
                { from: [140, 500], to: [1100, 250], type: 'working' },
                { from: [340, 500], to: [1100, 475], type: 'conflict' },
                { from: [540, 500], to: [1100, 475], type: 'conflict' },
                { from: [740, 500], to: [1100, 475], type: 'conflict' },
                { from: [940, 500], to: [1100, 475], type: 'conflict' }
            ],
            'module-manager': [
                { from: [550, 150], to: [200, 200], type: 'broken' },
                { from: [550, 150], to: [450, 200], type: 'broken' },
                { from: [550, 150], to: [700, 200], type: 'working' }
            ],
            'bridge-protocol': [
                { from: [200, 150], to: [400, 150], type: 'working' },
                { from: [500, 150], to: [700, 150], type: 'working' },
                { from: [400, 200], to: [400, 250], type: 'broken' }
            ],
            'personal-assistant': [
                { from: [475, 150], to: [190, 200], type: 'working' },
                { from: [475, 150], to: [390, 200], type: 'working' },
                { from: [475, 150], to: [590, 200], type: 'working' },
                { from: [475, 150], to: [790, 200], type: 'working' }
            ]
        };
        
        // Draw connections for a page
        function drawConnections(pageId) {
            const svgId = pageId === 'main' ? 'main-connections' : 
                          pageId === 'module-manager' ? 'mm-connections' :
                          pageId === 'bridge-protocol' ? 'bp-connections' :
                          pageId === 'personal-assistant' ? 'pa-connections' : null;
                          
            if (!svgId || !connections[pageId]) return;
            
            const svg = document.getElementById(svgId);
            svg.innerHTML = '';
            
            connections[pageId].forEach(conn => {
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                const [x1, y1] = conn.from;
                const [x2, y2] = conn.to;
                const midY = (y1 + y2) / 2;
                
                path.setAttribute('d', `M ${x1} ${y1} C ${x1} ${midY}, ${x2} ${midY}, ${x2} ${y2}`);
                path.setAttribute('class', `connection connection-${conn.type}`);
                
                svg.appendChild(path);
            });
        }
        
        // Initial page load
        drawConnections('main');
    </script>
</body>
</html>